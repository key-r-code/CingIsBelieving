#include <sys/mman.h>
#include <fcntl.h>
#include <unistd.h>
#include <string.h>
#include <stdlib.h>
#include <stdio.h>



#define MEM_SIZE 10

int main(int argc, char **argv){

    char *addr;
    int fd;

    addr = mmap(NULL, MEM_SIZE, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);
    if (addr == MAP_FAILED){
        fprintf(stderr, "mmap() failed\n");
        exit(EXIT_FAILURE);
    }

    if (close(fd) == -1){
        fprintf(stderr, "close() failed \n");
        exit(EXIT_FAILURE);
    }

    printf("Current Contents: %.s*\n", MEM_SIZE, addr);

    if (argc > 1){
        if (strlen(argv[1]) >= MEM_SIZE){
            fprintf(stderr, "New string is too long\n");
            exit(EXIT_FAILURE);
        }

        memset(addr, 0, MEM_SIZE);
        strncpy(addr, argv[1], MEM_SIZE - 1);

        if (mysync(addr, MEM_SIZE, MS_SYNC))
    }

}